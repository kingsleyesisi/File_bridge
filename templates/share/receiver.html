<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Join Room - FileBridge</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://kit.fontawesome.com/edec7f25e3.js" crossorigin="anonymous"></script>
    <link rel="shortcut icon" href="{{ url_for('static', filename='Filebridge.png') }}" type="image/x-icon">
</head>

<body class="receiver-body-minimal">
    <!-- Main Container -->
    <div class="receiver-container-minimal">
        <!-- Header Section -->
        <div class="receiver-header-minimal">
            <div class="logo-section-minimal">
                <div class="logo-icon-minimal">
                    <i class="fas fa-bridge"></i>
                </div>
                <h1 class="logo-text-minimal">FileBridge</h1>
            </div>
            <p class="tagline-minimal">Secure file sharing & real-time chat</p>
        </div>

        <!-- Main Content -->
        <div class="receiver-main-minimal">
            <!-- Join Form Card -->
            <div class="join-card-minimal">
                <div class="card-header-minimal">
                    <div class="card-icon-minimal">
                        <i class="fas fa-users"></i>
                    </div>
                    <h2>Join or Create Room</h2>
                    <p>Connect instantly to share files and chat</p>
                </div>

                <form action="{{ url_for('sender') }}" method="POST" class="join-form-minimal">
                    <div class="form-group-minimal">
                        <label for="username">
                            <i class="fas fa-user"></i>
                            Display Name
                        </label>
                        <input 
                            type="text" 
                            id="username" 
                            name="username" 
                            placeholder="Enter your name"
                            maxlength="50"
                            required
                        >
                    </div>

                    <div class="form-group-minimal">
                        <label for="Room_Name">
                            <i class="fas fa-hashtag"></i>
                            Room Name
                        </label>
                        <input 
                            type="text" 
                            id="Room_Name" 
                            name="Room_Name" 
                            placeholder="Enter room name"
                            maxlength="100"
                            required
                        >
                    </div>

                    <div class="form-message-minimal" id="form-message"></div>

                    <button type="submit" class="join-btn-minimal" id="join-btn">
                        <i class="fas fa-sign-in-alt"></i>
                        <span>Connect to Room</span>
                        <div class="btn-loader-minimal" style="display: none;">
                            <i class="fas fa-spinner fa-spin"></i>
                        </div>
                    </button>
                </form>
            </div>

            <!-- Features Grid -->
            <div class="features-grid-minimal">
                <div class="feature-item-minimal">
                    <div class="feature-icon-minimal file-icon">
                        <i class="fas fa-file-upload"></i>
                    </div>
                    <div class="feature-content-minimal">
                        <h4>File Transfer</h4>
                        <p>Share files up to 50MB instantly</p>
                    </div>
                </div>

                <div class="feature-item-minimal">
                    <div class="feature-icon-minimal chat-icon">
                        <i class="fas fa-comments"></i>
                    </div>
                    <div class="feature-content-minimal">
                        <h4>Real-time Chat</h4>
                        <p>Chat while sharing files</p>
                    </div>
                </div>

                <div class="feature-item-minimal">
                    <div class="feature-icon-minimal secure-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <div class="feature-content-minimal">
                        <h4>Secure & Private</h4>
                        <p>Encrypted file transfers</p>
                    </div>
                </div>

                <div class="feature-item-minimal">
                    <div class="feature-icon-minimal link-icon">
                        <i class="fas fa-link"></i>
                    </div>
                    <div class="feature-content-minimal">
                        <h4>Shareable Links</h4>
                        <p>Generate permanent file links</p>
                    </div>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="stats-minimal">
                <div class="stat-minimal">
                    <span class="stat-number-minimal">50MB</span>
                    <span class="stat-label-minimal">Max File Size</span>
                </div>
                <div class="stat-minimal">
                    <span class="stat-number-minimal">âˆž</span>
                    <span class="stat-label-minimal">Files Per Room</span>
                </div>
                <div class="stat-minimal">
                    <span class="stat-number-minimal">0s</span>
                    <span class="stat-label-minimal">Setup Time</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer-minimal">
        <div class="footer-content-minimal">
            <div class="footer-nav-minimal">
                <a href="/main" class="footer-link-minimal">
                    <i class="fas fa-home"></i>
                    <span>Home</span>
                </a>
                <a href="/instructions" class="footer-link-minimal">
                    <i class="fas fa-book-open"></i>
                    <span>Guide</span>
                </a>
            </div>
            <div class="footer-info-minimal">
                <p>&copy; 2025 FileBridge. Secure file sharing made simple.</p>
            </div>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='app.js') }}"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.querySelector('.join-form-minimal');
            const usernameInput = document.getElementById('username');
            const roomInput = document.getElementById('Room_Name');
            const joinBtn = document.getElementById('join-btn');
            const formMessage = document.getElementById('form-message');

            function validateForm() {
                const username = usernameInput.value.trim();
                const roomName = roomInput.value.trim();
                
                formMessage.textContent = '';
                formMessage.className = 'form-message-minimal';
                
                if (!username || !roomName) {
                    showMessage('Please fill in both fields', 'error');
                    joinBtn.disabled = true;
                    return false;
                }
                
                if (username.length < 2) {
                    showMessage('Name must be at least 2 characters', 'error');
                    joinBtn.disabled = true;
                    return false;
                }
                
                if (roomName.length < 3) {
                    showMessage('Room name must be at least 3 characters', 'error');
                    joinBtn.disabled = true;
                    return false;
                }
                
                const validPattern = /^[a-zA-Z0-9\s\-_]+$/;
                if (!validPattern.test(username) || !validPattern.test(roomName)) {
                    showMessage('Only letters, numbers, spaces, hyphens, and underscores allowed', 'error');
                    joinBtn.disabled = true;
                    return false;
                }
                
                showMessage('Ready to connect!', 'success');
                joinBtn.disabled = false;
                return true;
            }

            function showMessage(message, type) {
                formMessage.textContent = message;
                formMessage.className = `form-message-minimal ${type}`;
            }

            usernameInput.addEventListener('input', validateForm);
            roomInput.addEventListener('input', validateForm);
            validateForm();
            
            form.addEventListener('submit', function(e) {
                if (!validateForm()) {
                    e.preventDefault();
                    return false;
                }
                
                const btnText = joinBtn.querySelector('span');
                const btnLoader = joinBtn.querySelector('.btn-loader-minimal');
                const btnIcon = joinBtn.querySelector('i:not(.fa-spinner)');
                
                btnIcon.style.display = 'none';
                btnText.textContent = 'Connecting...';
                btnLoader.style.display = 'inline-block';
                joinBtn.disabled = true;
            });

            // Auto-populate room name from URL
            const urlParams = new URLSearchParams(window.location.search);
            const roomParam = urlParams.get('room');
            if (roomParam) {
                roomInput.value = decodeURIComponent(roomParam);
                validateForm();
            }

            // Enhanced input effects
            const inputs = document.querySelectorAll('input');
            inputs.forEach(input => {
                input.addEventListener('focus', function() {
                    this.parentElement.classList.add('focused');
                });
                
                input.addEventListener('blur', function() {
                    this.parentElement.classList.remove('focused');
                    if (this.value) {
                        this.parentElement.classList.add('filled');
                    } else {
                        this.parentElement.classList.remove('filled');
                    }
                });

                if (input.value) {
                    input.parentElement.classList.add('filled');
                }
            });
        });
    </script>
</body>
</html>